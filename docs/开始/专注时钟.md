---
title: ä¸“æ³¨æ—¶é’Ÿ
icon: lucide/alarm-clock
hide:
  - navigation
  - toc
  - footer
---

<!-- å…¨å±åº”ç”¨å®¹å™¨ -->
<div id="focus-app" class="focus-app-wrapper theme-pomodoro">
  
  <div class="focus-card">
    <!-- é¡¶éƒ¨æ¨¡å¼åˆ‡æ¢ -->
    <div class="mode-tabs">
      <button class="tab-item active" onclick="app.switchMode('pomodoro')">ğŸ… ç•ªèŒ„ä¸“æ³¨</button>
      <button class="tab-item" onclick="app.switchMode('custom')">â³ è‡ªå®šä¹‰å€’è®¡æ—¶</button>
      <button class="tab-item" onclick="app.switchMode('stopwatch')">â±ï¸ æ­£å‘è®¡æ—¶</button>
    </div>

    <!-- æ ¸å¿ƒæ˜¾ç¤ºåŒº -->
    <div class="display-area">
      
      <!-- 1. çº¯æ•°å­—æ˜¾ç¤º -->
      <div id="static-display" class="big-digits">25:00</div>

      <!-- 2. è¾“å…¥æ§ä»¶ -->
      <div id="custom-inputs" class="input-group" style="display:none;">
        <div class="input-wrapper">
          <input type="number" id="in-hrs" placeholder="00" min="0" max="99">
          <span class="label">æ—¶</span>
        </div>
        <span class="colon">:</span>
        <div class="input-wrapper">
          <input type="number" id="in-mins" placeholder="00" min="0" max="59">
          <span class="label">åˆ†</span>
        </div>
        <span class="colon">:</span>
        <div class="input-wrapper">
          <input type="number" id="in-secs" placeholder="00" min="0" max="59">
          <span class="label">ç§’</span>
        </div>
      </div>
      
      <!-- çŠ¶æ€æç¤º -->
      <div id="status-text" class="status-label">å‡†å¤‡å°±ç»ª</div>
    </div>

    <!-- æ§åˆ¶æŒ‰é’®ç»„ -->
    <div class="control-bar">
      <button id="main-btn" class="btn-primary" onclick="app.toggleTimer()">å¼€å§‹è®¡æ—¶</button>
      <button id="reset-btn" class="btn-icon" onclick="app.resetTimer()" title="é‡ç½®">
        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
          <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
          <path d="M3 3v5h5"></path>
        </svg>
      </button>
    </div>

    <!-- ç•ªèŒ„é’Ÿä¸“å±å¿«æ·æŒ‰é’® -->
    <div id="pomo-shortcuts" class="shortcuts">
      <button onclick="app.setPomoTime(25)">25 åˆ†é’Ÿ</button>
      <button onclick="app.setPomoTime(5)">5 åˆ†é’Ÿ</button>
      <button onclick="app.setPomoTime(15)">15 åˆ†é’Ÿ</button>
    </div>
  </div>
  
  <!-- åº•éƒ¨ä»»åŠ¡æ  -->
  <div class="task-section">
    <input type="text" class="task-input" placeholder="âœ¨ æ­¤æ—¶æ­¤åˆ»ï¼Œä½ çš„ç›®æ ‡æ˜¯..." />
  </div>

  <!-- ã€æ–°å¢ã€‘Toast æ¶ˆæ¯å®¹å™¨ -->
  <div id="toast-container" class="toast-container"></div>

  <!-- ã€æ–°å¢ã€‘è‡ªå®šä¹‰æ¨¡æ€æ¡† (Confirm/Alert) -->
  <div id="custom-modal" class="modal-overlay" style="display: none;">
    <div class="modal-box">
      <h3 id="modal-title" class="modal-title">æç¤º</h3>
      <p id="modal-msg" class="modal-msg">å†…å®¹æ–‡æœ¬</p>
      <div class="modal-actions">
        <button id="modal-cancel-btn" class="modal-btn cancel">å–æ¶ˆ</button>
        <button id="modal-confirm-btn" class="modal-btn confirm">ç¡®å®š</button>
      </div>
    </div>
  </div>

</div>

<!-- æç¤ºéŸ³ -->
<audio id="sound-alarm" src="data:audio/mp3;base64,//NExAAAAANIAAAAAExBTUUszLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//NExAAAAANIAAAAAExBTUUszLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"></audio>

<style>
/* --- å…¨å±€é‡ç½®ä¸å¸ƒå±€ --- */
.md-content__inner, .md-main__inner { margin: 0; padding: 0; max-width: none; }
header.md-header { display: none; }

:root {
  --theme-pomo: #d95550;
  --theme-custom: #785ebb;
  --theme-stop: #4c9195;
  --bg-current: var(--theme-pomo);
}

.focus-app-wrapper {
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 100vh;
  background-color: var(--bg-current);
  z-index: 9999;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  font-family: "Nunito", "PingFang SC", "Microsoft YaHei", sans-serif;
  color: white;
  transition: background-color 0.5s ease;
}

/* --- å¡ç‰‡æ ·å¼ --- */
.focus-card {
  background: rgba(255, 255, 255, 0.12);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  padding: 40px;
  border-radius: 24px;
  width: 90%; max-width: 500px;
  text-align: center;
  box-shadow: 0 20px 40px rgba(0,0,0,0.15);
  border: 1px solid rgba(255,255,255,0.1);
  position: relative;
  z-index: 10;
}

/* --- é¡¶éƒ¨ Tab --- */
.mode-tabs {
  display: flex; justify-content: center; gap: 8px;
  margin-bottom: 40px;
  background: rgba(0,0,0,0.1);
  padding: 5px; border-radius: 50px;
  width: fit-content; margin-left: auto; margin-right: auto;
}
.tab-item {
  background: none; border: none; color: rgba(255,255,255,0.7);
  padding: 8px 16px; border-radius: 20px; cursor: pointer;
  font-size: 14px; font-weight: bold; transition: all 0.2s;
}
.tab-item.active {
  background: white; color: var(--bg-current); box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

/* --- æ˜¾ç¤ºåŒºåŸŸ --- */
.display-area { min-height: 150px; display: flex; flex-direction: column; justify-content: center; align-items: center; margin-bottom: 20px; }

.big-digits {
  font-size: 100px; font-weight: 700; line-height: 1;
  font-variant-numeric: tabular-nums; letter-spacing: 2px;
  text-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.status-label {
  margin-top: 10px; font-size: 16px; opacity: 0.8; letter-spacing: 1px; font-weight: 300;
}

/* --- è¾“å…¥æ¡† --- */
.input-group { display: flex; align-items: center; gap: 10px; }
.input-wrapper { display: flex; flex-direction: column; align-items: center; }
.input-group input {
  background: rgba(255,255,255,0.15); border: 2px solid transparent;
  border-radius: 12px; color: white;
  width: 80px; height: 80px;
  font-size: 40px; text-align: center; outline: none;
  transition: all 0.2s;
}
.input-group input:focus { background: white; color: var(--bg-current); }
.input-group input::-webkit-outer-spin-button,
.input-group input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
.input-group .label { font-size: 12px; margin-top: 5px; opacity: 0.7; }
.input-group .colon { font-size: 40px; font-weight: bold; margin-bottom: 25px; }

/* --- æŒ‰é’® --- */
.control-bar { display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 20px; }
.btn-primary {
  background: white; color: var(--bg-current);
  border: none; padding: 18px 50px; font-size: 22px; font-weight: bold;
  border-radius: 16px; cursor: pointer; text-transform: uppercase;
  box-shadow: 0 6px 0 rgba(230,230,230,1);
  transition: transform 0.1s, box-shadow 0.1s, color 0.3s;
  min-width: 180px;
}
.btn-primary:active { transform: translateY(6px); box-shadow: none; }
.btn-icon {
  background: rgba(255,255,255,0.2); border: none;
  width: 50px; height: 50px; border-radius: 50%;
  color: white; cursor: pointer; display: flex; align-items: center; justify-content: center;
  transition: background 0.2s;
}
.btn-icon:hover { background: rgba(255,255,255,0.4); }

.shortcuts { display: flex; gap: 10px; justify-content: center; height: 30px; }
.shortcuts button {
  background: none; border: 1px solid rgba(255,255,255,0.3);
  color: white; padding: 4px 12px; border-radius: 15px; cursor: pointer; font-size: 13px;
  transition: background 0.2s;
}
.shortcuts button:hover { background: rgba(255,255,255,0.2); }

.task-section { margin-top: 40px; width: 100%; text-align: center; z-index: 10; }
.task-input {
  background: transparent; border: none; border-bottom: 2px solid rgba(255,255,255,0.3);
  width: 300px; color: white; font-size: 18px; text-align: center; padding: 10px;
  outline: none; transition: border 0.3s;
}
.task-input:focus { border-bottom-color: white; }
.task-input::placeholder { color: rgba(255,255,255,0.6); font-style: italic; }

/* --- ã€æ–°å¢ã€‘Toast æ ·å¼ --- */
.toast-container {
  position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
  z-index: 10001;
  display: flex; flex-direction: column; gap: 10px;
  pointer-events: none;
}
.toast {
  background: rgba(255, 255, 255, 0.95);
  color: #333;
  padding: 12px 24px;
  border-radius: 50px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  font-weight: 600; font-size: 14px;
  opacity: 0; transform: translateY(-20px);
  animation: toastIn 0.3s forwards;
}
@keyframes toastIn { to { opacity: 1; transform: translateY(0); } }
@keyframes toastOut { to { opacity: 0; transform: translateY(-20px); } }

/* --- ã€æ–°å¢ã€‘Modal æ ·å¼ --- */
.modal-overlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.4);
  backdrop-filter: blur(4px);
  z-index: 10000;
  display: flex; justify-content: center; align-items: center;
  animation: fadeIn 0.2s ease-out;
}
.modal-box {
  background: white; color: #333;
  width: 85%; max-width: 320px;
  border-radius: 20px; padding: 24px;
  text-align: center;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  transform: scale(0.9);
  animation: scaleUp 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
}
.modal-title { margin: 0 0 10px; font-size: 20px; color: var(--bg-current); }
.modal-msg { margin: 0 0 24px; color: #666; font-size: 15px; line-height: 1.5; }
.modal-actions { display: flex; gap: 12px; justify-content: center; }
.modal-btn {
  border: none; padding: 10px 20px; border-radius: 10px;
  font-weight: bold; cursor: pointer; flex: 1; transition: opacity 0.2s;
}
.modal-btn.cancel { background: #f0f0f0; color: #666; }
.modal-btn.confirm { background: var(--bg-current); color: white; }
.modal-btn:hover { opacity: 0.9; }

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes scaleUp { to { transform: scale(1); } }

@media (max-width: 600px) {
  .big-digits { font-size: 70px; }
  .focus-card { padding: 25px 15px; width: 95%; }
  .input-group input { width: 60px; height: 60px; font-size: 30px; }
}
</style>

<script>
window.app = (function() {
  // çŠ¶æ€å˜é‡
  let state = {
    mode: 'pomodoro', 
    isRunning: false,
    intervalId: null,
    totalSeconds: 25 * 60,
    elapsedSeconds: 0 
  };
  
  const modes = {
    pomodoro: { color: 'var(--theme-pomo)', label: 'ä¸“æ³¨ä¸­', default: 25 * 60 },
    custom:   { color: 'var(--theme-custom)', label: 'å€’è®¡æ—¶', default: 0 },
    stopwatch:{ color: 'var(--theme-stop)',   label: 'æ­£è®¡æ—¶', default: 0 }
  };
  
  // DOM å…ƒç´ ç¼“å­˜
  const els = {
    bg: document.documentElement,
    display: document.getElementById('static-display'),
    inputs: document.getElementById('custom-inputs'),
    mainBtn: document.getElementById('main-btn'),
    status: document.getElementById('status-text'),
    shortcuts: document.getElementById('pomo-shortcuts'),
    tabs: document.querySelectorAll('.tab-item'),
    inH: document.getElementById('in-hrs'),
    inM: document.getElementById('in-mins'),
    inS: document.getElementById('in-secs'),
    audio: document.getElementById('sound-alarm'),
    // UI å¼¹çª—å…ƒç´ 
    toastContainer: document.getElementById('toast-container'),
    modal: document.getElementById('custom-modal'),
    modalTitle: document.getElementById('modal-title'),
    modalMsg: document.getElementById('modal-msg'),
    modalConfirmBtn: document.getElementById('modal-confirm-btn'),
    modalCancelBtn: document.getElementById('modal-cancel-btn')
  };

  // --- UI å·¥å…·å‡½æ•°ï¼šæ›¿ä»£ Alert å’Œ Confirm ---

  function showToast(msg) {
    const el = document.createElement('div');
    el.className = 'toast';
    el.innerText = msg;
    els.toastContainer.appendChild(el);
    setTimeout(() => {
      el.style.animation = 'toastOut 0.3s forwards';
      el.addEventListener('animationend', () => el.remove());
    }, 2500);
  }

  function showModal(options) {
    const { title, msg, onConfirm, showCancel = true, confirmText = 'ç¡®å®š' } = options;
    
    els.modalTitle.innerText = title;
    els.modalMsg.innerText = msg;
    els.modalConfirmBtn.innerText = confirmText;
    
    // è®¾ç½®æŒ‰é’®é¢œè‰²ä»¥åŒ¹é…å½“å‰ä¸»é¢˜
    els.modalConfirmBtn.style.backgroundColor = modes[state.mode].color;
    els.modalTitle.style.color = modes[state.mode].color;

    els.modalCancelBtn.style.display = showCancel ? 'block' : 'none';
    els.modal.style.display = 'flex';

    // æ¸…ç†ä¹‹å‰çš„äº‹ä»¶ç›‘å¬
    const newConfirm = els.modalConfirmBtn.cloneNode(true);
    const newCancel = els.modalCancelBtn.cloneNode(true);
    els.modalConfirmBtn.replaceWith(newConfirm);
    els.modalCancelBtn.replaceWith(newCancel);
    els.modalConfirmBtn = newConfirm;
    els.modalCancelBtn = newCancel;

    // ç»‘å®šæ–°äº‹ä»¶
    els.modalConfirmBtn.onclick = () => {
      els.modal.style.display = 'none';
      if (onConfirm) onConfirm();
    };
    els.modalCancelBtn.onclick = () => {
      els.modal.style.display = 'none';
    };
  }

  // --- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ ---

  function switchMode(newMode) {
    // å¦‚æœæ­£åœ¨è®¡æ—¶ï¼Œéœ€ç¡®è®¤
    if (state.isRunning) {
      showModal({
        title: "åˆ‡æ¢æ¨¡å¼?",
        msg: "å½“å‰è®¡æ—¶å°†è¢«é‡ç½®ï¼Œç¡®å®šè¦åˆ‡æ¢å—ï¼Ÿ",
        onConfirm: () => {
          resetTimer();
          _executeSwitch(newMode);
        }
      });
      return;
    }
    _executeSwitch(newMode);
  }

  function _executeSwitch(newMode) {
    state.mode = newMode;
    state.elapsedSeconds = 0;
    
    // ä¸»é¢˜åˆ‡æ¢
    els.bg.style.setProperty('--bg-current', modes[newMode].color);
    els.tabs.forEach(t => t.classList.remove('active'));
    
    const idx = ['pomodoro', 'custom', 'stopwatch'].indexOf(newMode);
    if(els.tabs[idx]) els.tabs[idx].classList.add('active');

    // ç•Œé¢é€»è¾‘
    if (newMode === 'pomodoro') {
      showDisplayOnly();
      els.shortcuts.style.display = 'flex';
      state.totalSeconds = modes.pomodoro.default;
      updateDisplay(state.totalSeconds);
      els.status.innerText = "å‡†å¤‡ä¸“æ³¨";
    } 
    else if (newMode === 'custom') {
      showInputsOnly();
      els.shortcuts.style.display = 'none';
      els.status.innerText = "è®¾ç½®æ—¶é—´";
    } 
    else if (newMode === 'stopwatch') {
      showDisplayOnly();
      els.shortcuts.style.display = 'none';
      updateDisplay(0);
      els.status.innerText = "å‡†å¤‡å¼€å§‹";
    }
  }

  function toggleTimer() {
    state.isRunning ? pauseTimer() : startTimer();
  }

  function startTimer() {
    // è‡ªå®šä¹‰æ¨¡å¼æ£€æŸ¥
    if (state.mode === 'custom' && els.display.style.display === 'none') {
      const h = parseInt(els.inH.value) || 0;
      const m = parseInt(els.inM.value) || 0;
      const s = parseInt(els.inS.value) || 0;
      const total = h * 3600 + m * 60 + s;
      
      if (total <= 0) {
        showToast("â³ è¯·è®¾ç½®ä¸€ä¸ªæœ‰æ•ˆçš„æ—¶é—´ï¼"); // ä¼˜åŒ– 1
        return;
      }
      state.totalSeconds = total;
      showDisplayOnly();
      updateDisplay(total);
    }

    state.isRunning = true;
    els.mainBtn.innerText = "æš‚åœ";
    els.mainBtn.style.boxShadow = "none";
    els.mainBtn.style.transform = "translateY(6px)";
    els.status.innerText = modes[state.mode].label;

    state.intervalId = setInterval(tick, 1000);
  }

  function pauseTimer() {
    state.isRunning = false;
    clearInterval(state.intervalId);
    els.mainBtn.innerText = "ç»§ç»­";
    els.mainBtn.style.boxShadow = ""; 
    els.mainBtn.style.transform = "";
    els.status.innerText = "å·²æš‚åœ";
  }

  function resetTimer() {
    pauseTimer();
    els.mainBtn.innerText = "å¼€å§‹è®¡æ—¶";
    document.title = "å…¨èƒ½ä¸“æ³¨æ—¶é’Ÿ";
    
    if (state.mode === 'pomodoro') {
      state.totalSeconds = modes.pomodoro.default;
      updateDisplay(state.totalSeconds);
      els.status.innerText = "å‡†å¤‡ä¸“æ³¨";
    } 
    else if (state.mode === 'custom') {
      showInputsOnly();
      els.status.innerText = "è®¾ç½®æ—¶é—´";
    } 
    else if (state.mode === 'stopwatch') {
      state.elapsedSeconds = 0;
      updateDisplay(0);
      els.status.innerText = "å‡†å¤‡å¼€å§‹";
    }
  }

  function tick() {
    if (state.mode === 'stopwatch') {
      state.elapsedSeconds++;
      updateDisplay(state.elapsedSeconds);
      document.title = `${formatTime(state.elapsedSeconds)} - æ­£è®¡æ—¶`;
    } else {
      if (state.totalSeconds > 0) {
        state.totalSeconds--;
        updateDisplay(state.totalSeconds);
        document.title = `${formatTime(state.totalSeconds)} - ${state.mode === 'pomodoro' ? 'ä¸“æ³¨' : 'å€’è®¡æ—¶'}`;
      } else {
        finish();
      }
    }
  }

  function finish() {
    pauseTimer();
    state.isRunning = false;
    els.mainBtn.innerText = "å®Œæˆ";
    els.status.innerText = "æ—¶é—´åˆ°ï¼";
    try { els.audio.play(); } catch(e){}
    
    // ä¼˜åŒ– 2ï¼šä½¿ç”¨ Modal æ›¿ä»£ alert
    showModal({
      title: "ğŸ‰ æ—¶é—´åˆ°ï¼",
      msg: "éå¸¸æ£’ï¼ä½ åˆšåˆšå®Œæˆäº†ä¸€æ®µä¸“æ³¨æ—¶å…‰ã€‚ä¼‘æ¯ä¸€ä¸‹å§ã€‚",
      confirmText: "çŸ¥é“äº†",
      showCancel: false,
      onConfirm: () => {
        // ç‚¹å‡»ç¡®è®¤åçš„å¯é€‰æ“ä½œï¼Œæ¯”å¦‚é‡ç½®
        // resetTimer(); 
      }
    });
  }

  // --- è¾…åŠ©åŠŸèƒ½ ---

  function showDisplayOnly() {
    els.display.style.display = 'block';
    els.inputs.style.display = 'none';
  }

  function showInputsOnly() {
    els.display.style.display = 'none';
    els.inputs.style.display = 'flex';
  }

  function updateDisplay(seconds) {
    els.display.innerText = formatTime(seconds);
  }

  function formatTime(totalSeconds) {
    const h = Math.floor(totalSeconds / 3600);
    const m = Math.floor((totalSeconds % 3600) / 60);
    const s = totalSeconds % 60;
    if (h > 0) return `${h}:${pad(m)}:${pad(s)}`;
    return `${pad(m)}:${pad(s)}`;
  }
  
  function pad(num) { return num.toString().padStart(2, '0'); }

  function setPomoTime(minutes) {
    if (state.isRunning) {
        showToast("ğŸš« è®¡æ—¶ä¸­æ— æ³•ä¿®æ”¹æ—¶é—´ï¼Œè¯·å…ˆé‡ç½®");
        return;
    }
    modes.pomodoro.default = minutes * 60;
    state.totalSeconds = minutes * 60;
    updateDisplay(state.totalSeconds);
    showToast(`âœ… å·²è®¾å®šä¸º ${minutes} åˆ†é’Ÿ`);
  }

  // åˆå§‹åŒ–
  updateDisplay(modes.pomodoro.default);

  return { switchMode, toggleTimer, resetTimer, setPomoTime };
})();
</script>